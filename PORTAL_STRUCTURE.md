# Структура презентации

## Общие положения

1. Презентация загружается в систему в виде архивированного пакета;
2. Поддерживает только формат .zip (форматы .7z, .rar, др. не поддерживаются);
3. Презентация всегда должна содержать файл index.html (открывается именно этот файл при старте презентации на планшете);
4. Возможно использовать любую структуру файлов и каталогов;
5. Рекомендуется использовать .html файлы в качестве слайдов презентации (см. пункт «Слайды презентации»);
6. Слайды презентации необходимо класть в «корень» вместе с index.html для того, чтобы система распознала их и включила сбор количественных метрик по ним;
7. Файлы с расширением .html могут находиться не только в корне презентации, но в таком случае они не будут считаться в системе «слайдами» и соответственно, по ним не будет автоматически собираться статистика, и они не будут включены в системную карту презентации (если она используется);
8. Медиафайлы (аудио, видео) необходимо класть в каталог с названием medifies (см. пункт «Медиафайлы»);
9. Медиафайлы также можно загружать отдельно от архива (в панели администратора);
10. В архиве не должно быть файлов недопустимых форматов (см. пункт «Недопустимые файлы»);
11. Для правильного отображения содержимого текстовых файлов, они должны быть в кодировке UTF-8;
12. Следует использовать латиницу в названиях файлов и каталогов в пакете для корректного отображения их имени;
13. Презентация может не содержать слайдов совсем (необходим только контент или используется как источник данных через API);
14. Пакет не имеют ограничений по размеру;
15. Название файла слайда имеет ограничение в 256 символов;
16. Название файла слайда может содержать символы любого регистра (кроме index.html);
17. Расширение слайда должно быть .html (в нижнем регистре);
18. Система позволяет использовать возможности HTML5, CSS3 и любые JavaScript библиотеки, которые поддерживаются JS-движком компонента UIWebView;
19. Код и верстка должны быть оптимизированы как для Mobile Safari;
20. В слайдах возможно использование AJAX для загрузки данных (скриптов, таблиц стилей, фреймов);
21. Внешние таблицы стилей и файлы со скриптами кэшируются на уровне приложения автоматически;
22. Если необходимо избежать кэширования, то необходимо добавлять в конец имени файла со стилем или скриптом знак "?";
23. Логика переходов между слайдами реализуется на уровне контента (например, через относительные ссылки и/или window.location)

> Поведение слайда полностью зависит только от его структуры, стилей и функциональности. Но необходимо учитывать, как ваши скрипты и контент загружают процессор и память устройства. Тяжелые слайды с сложными скриптами могут долго загружаться и медленно работать на устройствах старше iPad 4. Следует помнить, что мобильные устройства гораздо медленнее и обладает гораздо меньшими ресурсами чем персональные компьютеры.

## Медиафайлы

1. Медиафайлы должны находиться в корне директории mediafiles;
2. Поддерживаются только форматы .mp3, .wav, .mp4, .ogg, .webm, .pdf;
3. Только файлы указанных форматов в каталоге mediafiles будут доступны через специальные контроллер внутри приложения;
4. Все файлы иных расширений будут удаляться из директории mediafiles при загрузке архива презентации;
5. Все файлы любых расширений из подкаталогов каталога mediafiles будут удаляться при загрузке архива презентации;
6. Медиафайлы могут быть доступны из презентации и могут использоваться в логике слайда;
7. Имя медиафайла может быть записано в любом регистре;
8. Медиафайлы можно загружать независимо от самой презентации (например, появились новые материалы в .pdf) и данные обновления не потребуют обновления всей презентации на планшетах пользователей;
9. Медиафайлы, загруженные через панель администратора, появляются в папке mediafiles на планшетах пользователей и становятся доступны из презентации;

## Системная карта презентации

В приложении для iPad предусмотрена возможность для просмотра карты презентации, отображающей внутреннюю структуру слайдов и переходов между ними. Для того, чтобы карта заработала необходимо:

1. Прописать 3 мета-тега в каждом слайде презентации (clm-swipe-next, clm-swipe-previous и clm);
2. clm-swipe-next указывается слайд, в который мы можем переместиться из текущего по свайпу вперед, в clm-swipe-previous - слайд, в который мы можем переместиться из текущего по свайпу слева назад, в clm перечисляются все слайды, в которые мы можем переместиться с данного слайда;
3. В теге clm необходимо указать слайды в следующем порядке: первым идет предыдущий (который указан в clm-swipe-previous), далее следующий (указан в clm-swipe-next);
4. Если текущий слайд является узловым (разветвляющим), тогда в мета-теге clm указываются все имена слайдов, которые в рамках карты презентации являются дочерними к текущему;
5. Если на текущем слайде есть переходы на слайды, находящиеся не следом за текущем (либо перед ним), например, на slideX.html из другой ветки, то slideX.html не указывается в мета-тегах;

### Пример:

``` json
<head> 
    <meta name=”clm-swipe-next" content=”03.html">
    <meta name=”clm-swipe-previous" content=”05.html">
    <meta name=”clm" content="05.html, 03.html">
</head>
```
## Недопустимые файлы

Во время загрузки архива с презентацией из него будут удаляться все недопустимые файлы:

```
.apk, .bat, .bin, .cgi, .com, .cpp, .exe, .gadget, .jar, .msi, .msu, .paf, .pif, 
.pwz, .vb, .wsf, .ipa, .app, .coffee, .csh, .fxp, .hta, .inx, .phar, 
.plx, .pyc, .pyo, .asp, .aspx, .crdownload, .dll, .download, .eml, .flv, 
.htaccess, .jnlp, .jsp, .msg, .mso, .php, .prf, .swf, .torrent, .url, 
.webarchive, .webloc, .accdb, .b2, .db, .kdc, .log, .mdb, .mdf, .bak, .temp, 
.tmp, .cpl, .cur, .drv, .lnk, .reg, .rtp, .sys, .ini, .plist, .cfg, .eap.
```

